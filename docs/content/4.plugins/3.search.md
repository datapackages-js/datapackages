---
title: Search Plugin
description: Full-text search capabilities using Orama for fast, client-side indexing and searching.
---

# Search

The `@datapackages/plugin-search` middleware adds full-text search capabilities to your datasets using [Orama](https://oramasearch.com/), a fast, client-side, full-text search engine.

## Installation

```bash
npm install @datapackages/plugin-search
```

## Architecture

The search system separates **Build Time** (indexing) from **Runtime** (searching).

### Build Time

During the build process (`update-sources`), a compact search index (`search.index.json`) is generated from your source data.

### Runtime

The `withSearch` middleware loads this index and enables searching.

::mermaid
<pre>
sequenceDiagram
    participant User
    participant DS as Dataset
    participant Plugin as withSearch
    participant Index as Orama Index

    DS->>Plugin: onInit()
    Plugin->>DS: loadIndex()
    DS-->>Plugin: return search.index.json
    Plugin->>Index: orama.load(data)

    User->>DS: search("query")
    DS->>Plugin: search("query") [delegated]
    Plugin->>Index: search(orama, "query")
    Index-->>Plugin: return hits (ref IDs)
    Note over Plugin: Map hits to _dataStack
    Plugin-->>DS: return items[]
    DS-->>User: results
</pre>
::

## Usage

### Auto-detection (Recommended)

If your dataset class implements `loadIndex()`, the middleware detects and uses it.

```typescript
import { withSearch } from "@datapackages/plugin-search";

// In your service class
class CountryService extends Dataset<Country> {
  protected async loadIndex() {
    return (await import("./search.index.json")).default;
  }
}

// In usage
const ds = await service.use(withSearch());
await ds.init();

// Direct access to search() thanks to type-safe middleware
const results = await ds.search("query");
```

### Manual Loading

You can also provide the index loader directly.

```typescript
await service.use(withSearch(() => import("./search.index.json")));
```

## Features

- **Fuzzy Matching**: Finds results even with typos.
- **Field-Specific Search**: configure which fields to index.
- **Multilingual Support**: Search by native or translated names.
